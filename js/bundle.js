!function(t){var e={};function s(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(i,a,function(e){return t[e]}.bind(null,a));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){t.exports=s(16)},function(t,e,s){t.exports=s.p+"img/box_background.png"},function(t,e,s){t.exports=s.p+"img/box.png"},function(t,e,s){t.exports=s.p+"img/coins.jpg"},function(t,e,s){t.exports=s.p+"img/favicon.ico"},function(t,e,s){t.exports=s.p+"img/frame_background.png"},function(t,e,s){t.exports=s.p+"img/loading.gif"},function(t,e,s){t.exports=s.p+"img/menu_800x600.jpg"},function(t,e,s){t.exports=s.p+"img/modal_background.jpg"},function(t,e,s){t.exports=s.p+"img/pause.png"},function(t,e,s){t.exports=s.p+"img/sheet_objects_heroes.png"},function(t,e,s){t.exports=s.p+"img/texture.png"},function(t,e,s){t.exports=s.p+"font/Nautilus.otf"},function(t,e,s){t.exports=s.p+"font/SHPinscher-Regular.otf"},function(t,e){},function(t,e){},function(t,e,s){"use strict";s.r(e);s(1),s(2),s(3),s(4),s(5),s(6),s(7),s(8),s(9),s(10),s(11),s(12),s(13),s(14),s(15);function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e,s){return e&&n(t.prototype,e),s&&n(t,s),t}var r=function(){function t(){a(this,t),this.MAX_WRITE=0,this.currentIP=null}return o(t,[{key:"updateLimit",value:function(){var t=this;this.timer=setTimeout(function e(){t.MAX_WRITE=0,this.timer=setTimeout(e,6e4)},6e4)}},{key:"updateUserData",value:function(t,e,s,i){if(this.MAX_WRITE>3)throw new Error("limit");this.MAX_WRITE++,this.currentIP=t||"no ip detected",cloudDB.use.collection("users").doc("user_".concat((s+e).replace(/\s/g,"").toLowerCase())).set({name:s,points:i,id:e.slice(1,e.length),ip:this.currentIP,realPlayer:!0}).catch(function(t){console.log(t.message)})}}]),t}(),l=function(){function t(){a(this,t),this.key="json"}return o(t,[{key:"getIP",value:function(t){fetch("https://api.ipify.org?format=".concat(this.key)).then(function(t){return t.json()}).then(function(t){t.ip?localStorage.IP=t.ip:localStorage.IP="no detected"}).catch(function(t){console.log(t.message)})}},{key:"getSpriteData",value:function(t){fetch("../storage/data.json").then(function(t){return t.json()}).then(function(e){return t.jsonData=e}).catch(function(t){console.log(t.message)})}}]),t}(),u=function(){function t(){a(this,t),this.effects=[],this.ctx=null,this.gainNode=null,this.loaded=!1,this.time=null,this.lastTime=null}return o(t,[{key:"init",value:function(){this.ctx=new AudioContext,this.gainNode=this.ctx.createGain?this.ctx.createGain():this.ctx.createGainNode(),this.gainNode.connect(this.ctx.destination),this.time=this.ctx.currentTime}},{key:"load",value:function(t,e){var s=this,i={},a=this;fetch(t).then(function(t){return t.arrayBuffer()}).then(function(n){s.ctx.decodeAudioData(n).then(function(s){i.name=e,i.path=t,i.buffer=s,i.loaded=!0,a.effects.push(i)}).then(function(){i.play=function(t,e){if(i.loaded){var s=a.ctx.createBufferSource();s.buffer=this.buffer,s.connect(a.gainNode),s.loop=t,a.gainNode.gain.value=e,s.start(0)}}})})}},{key:"stopAll",value:function(){this.gainNode.disconnect(),this.gainNode=this.ctx.createGain?this.ctx.createGain(0):this.ctx.createGainNode(0),this.gainNode.connect(this.ctx.destination)}}]),t}(),h=function(){function t(){a(this,t),this.linki=[],this.coordsMouseX=null,this.coordsMouseY=null}return o(t,[{key:"checkFrame",value:function(t){return this.coordsMouseX>t.pos[0]&&this.coordsMouseX<t.pos[0]+t.length[0]&&this.coordsMouseY>t.pos[1]&&this.coordsMouseY<t.pos[1]+t.length[1]}}]),t}(),p=function(){function t(){a(this,t),this.menu="menu",this.death="wait",this.rating="rating",this.play="play",this.startPlay="play-animation",this.pauseGame="pause",this.fade=1,this.loadingPercent=0,this.about={state:"loading",count:0,stageBossCount:0,stageExtraBossCount:0,stageNumber:0,lastTimeBull:0,requstCount:0,lastTime:0,lastTimeColl:0}}return o(t,[{key:"setRequstCount",value:function(t){return this.about.requstCount=t}},{key:"startGame",value:function(){return this.about.state=this.play}},{key:"startGameAnimation",value:function(t,e,s,i){return s.selectName=!1,this.music(i),this.updateGameStatus(e,t),e.setHealth(200),this.about.state=this.startPlay}},{key:"stopGame",value:function(){return this.about.state=this.death}},{key:"ratingGame",value:function(t){return t.selectName=!1,this.about.state=this.rating}},{key:"mainMenu",value:function(t,e){return e&&e.stopAll(),t.selectName=!1,this.about.state=this.menu}},{key:"pause",value:function(t,e){return!!(e||t&&t.selectName)&&(t.selectName=!1,this.about.state=this.pauseGame,!0)}},{key:"spawnAndLvling",value:function(t,e,s,i,a){var n=s.createEnemy;t.about.stageNumber=i;var o=a.effects.find(function(t){return"bossExtra"===t.name}),r=a.effects.find(function(t){return"deathBat"===t.name}),l=a.effects.find(function(t){return"deathBoss"===t.name});if(t.about.stageNumber&&t.about.stageNumber==t.about.stageNumber){if(t.about.stageNumber<7)for(var u=0;u<t.about.stageNumber;u++)n(e,e.jsonData.essenceSettings.birds.health,e.jsonData.essenceSettings.birds.dmg,e.jsonData.essenceSettings.birds.name+u,e.jsonData.essenceSettings.birds.type,e.jsonData.essenceSettings.birds.x,e.jsonData.essenceSettings.birds.y,e.jsonData.essenceSettings.birds.sizeX,e.jsonData.essenceSettings.birds.sizeY,e.jsonData.essenceSettings.birds.frameCount,e.jsonData.essenceSettings.birds.frameArray,e.jsonData.enemyStartPosition.x,e.jsonData.enemyStartPosition.y,r);else if(t.about.stageNumber>=10)for(var h=0;h<t.about.stageExtraBossCount;h++)n(e,e.jsonData.essenceSettings.bossExtra.health,e.jsonData.essenceSettings.bossExtra.dmg,e.jsonData.essenceSettings.bossExtra.name+h,e.jsonData.essenceSettings.bossExtra.type,e.jsonData.essenceSettings.bossExtra.x,e.jsonData.essenceSettings.bossExtra.y,e.jsonData.essenceSettings.bossExtra.sizeX,e.jsonData.essenceSettings.bossExtra.sizeY,e.jsonData.essenceSettings.bossExtra.frameCount,e.jsonData.essenceSettings.bossExtra.frameArray,e.jsonData.enemyStartPosition.x,e.jsonData.enemyStartPosition.y,o);if(t.about.stageNumber>=7&&t.about.stageNumber<=15){for(var p=0;p<5;p++)n(e,e.jsonData.essenceSettings.birds.health,e.jsonData.essenceSettings.birds.dmg,e.jsonData.essenceSettings.birds.name+p,e.jsonData.essenceSettings.birds.type,e.jsonData.essenceSettings.birds.x,e.jsonData.essenceSettings.birds.y,e.jsonData.essenceSettings.birds.sizeX,e.jsonData.essenceSettings.birds.sizeY,e.jsonData.essenceSettings.birds.frameCount,e.jsonData.essenceSettings.birds.frameArray,e.jsonData.enemyStartPosition.x,e.jsonData.enemyStartPosition.y,r);for(var f=0;f<t.about.stageBossCount;f++)n(e,e.jsonData.essenceSettings.boss.health,e.jsonData.essenceSettings.boss.dmg,e.jsonData.essenceSettings.boss.name+f,e.jsonData.essenceSettings.boss.type,e.jsonData.essenceSettings.boss.x,e.jsonData.essenceSettings.boss.y,e.jsonData.essenceSettings.boss.sizeX,e.jsonData.essenceSettings.boss.sizeY,e.jsonData.essenceSettings.boss.frameCount,e.jsonData.essenceSettings.boss.frameArray,e.jsonData.enemyStartPosition.x,e.jsonData.enemyStartPosition.y,l)}else if(t.about.stageNumber>15)for(var c=0;c<t.about.stageNumber-5;c++)n(e,e.jsonData.essenceSettings.bossExtra.health,e.jsonData.essenceSettings.bossExtra.dmg,e.jsonData.essenceSettings.bossExtra.name+j,e.jsonData.essenceSettings.bossExtra.type,e.jsonData.essenceSettings.bossExtra.x,e.jsonData.essenceSettings.bossExtra.y,e.jsonData.essenceSettings.bossExtra.sizeX,e.jsonData.essenceSettings.bossExtra.sizeY,e.jsonData.essenceSettings.bossExtra.frameCount,e.jsonData.essenceSettings.bossExtra.frameArray,e.jsonData.enemyStartPosition.x,e.jsonData.enemyStartPosition.y,o)}}},{key:"updateGameStatus",value:function(t,e){this.about.stageNumber=-1,this.about.stageExtraBossCount=1,this.about.stageBossCount=-1,this.about.count=-1,this.fade=2,this.loadingPercent=0,t.countThrow=0,t.killCount=0,t.stat.points=0,t.SoundCount=0,e.enemy=[],t.bullets=[],e.bullets=[],e.coins=[],e.eat=[],t.stat.sprite.size[0]=34,t.stat.sprite.pos[0]=700,t.move.pos[0]=t.move.startPos[0],t.move.pos[1]=t.move.startPos[1]}},{key:"music",value:function(t){setTimeout(function(){t.effects.find(function(t){return"main"===t.name}).play(!0,1)},2500)}}]),t}(),f=function(){function t(){a(this,t),this.loadCount=1,this.jsonData=[],this.TextureStorage=[],this.SpriteStorage=[],this.SoundsStorage=[],this.enemy=[],this.bullets=[],this.coins=[],this.eat=[],this.upgrade=[],this.startRecord=[]}return o(t,[{key:"textureCache",value:function(t){return this.TextureStorage.push(t)}},{key:"SpriteCache",value:function(t){return this.SpriteStorage.push(t)}},{key:"SoundCache",value:function(t){return this.SoundsStorage.push(t)}},{key:"loading",value:function(t,e,s){if("Image"===t&&"texture"===s){var i=new Image;i.src=e,this.textureCache(i)}else if("Image"===t&&"sprite"===s){var a=new Image;a.src=e,this.SpriteCache(a)}if("Audio"===t){var n=new Audio;n.src=e,this.SoundCache(n)}}}]),t}(),c=function(){function t(e,s){a(this,t);this.gameTime=0,this.countThrow=0,this.killCount=0,this.SoundCount=0,this.bullets=[],this.stat={name:"player",gamerName:null,health:200,points:0,damage:25,whatDrop:!1,upgradeRate:!1,sprite:new m("player",e.SpriteStorage[0],[703,0],[31,34],2,[0,1]),bullets:new d},this.move={speeds:200,pos:[s.settings.width/2,s.settings.height/2],startPos:[385,-120],animationPos:[s.settings.width/2,s.settings.height/2]}}return o(t,[{key:"setHealth",value:function(t){return this.stat.health=t}},{key:"GameOver",value:function(t,e,s,i){t.stat.health<=0&&(s.enemy=[],!t.SoundCount&&e.about.stageNumber<20&&(i.effects.find(function(t){return"gameOver"===t.name}).play(!1,.5),t.SoundCount++),e.stopGame())}},{key:"Win",value:function(t,e,s){t.stat.health<0||s.enemy.length||e.about.count||(e.about.stageNumber++,e.about.count++)}}]),t}(),d=function(){function t(){a(this,t),this.lastFire=0,this.i=50,this.weapons={speed:320,active:!1}}return o(t,[{key:"useSkill",value:function(t,e,s,i){if(Date.now()-this.lastFire>300)return e.countThrow++,t.bullets.push({pos:{x:e.move.pos[0],y:e.move.pos[1]},direction:new Vector(s.coorddX,s.coorddY).normalize(),degree:0,sprite:this.createBullets(t),siz:[15,32]}),i.effects.find(function(t){return"shot"===t.name}).play(!1,.8),this.lastFire=Date.now(),this.weapons.active=!0}},{key:"createBullets",value:function(t){return new m("bull",t.SpriteStorage[0],[192.5,31],[32,36],0)}},{key:"createBulletsCustom",value:function(t,e,s){return new m("bull2",t.SpriteStorage[0],[e,s],[22,34],0)}}]),t}(),g=function(){function t(){a(this,t),this.enemySpeedX=1*y(),this.enemySpeedY=1*y(),this.DeathTimer=null,this.stat={name:"",type:"",collision:!1,getDmg:!1,health:null,damage:null,sprite:null,sizes:[32,20],onDeath:!1},this.bull={bullStorage:[],speed:null,speedY:null,pos:[0,0],on:!1,lastBull:null},this.move={speeds:10,pos:[0,0],randomMove:y()}}return o(t,[{key:"createEnemy",value:function(e,s,i,a,n,o,r,l,u,h,p,f,c,d){var g=new t(e,this,s,i,a,n,o,r,l,u,h,p,d);g.stat.name=a,g.stat.type=n,g.stat.health=s,g.stat.damage=i,g.move.pos[0]=f*w(),g.move.pos[1]=c*w(),g.sound=d,("boss"===g.stat.type||"bossExtra"===g.stat.type)&&g.enemySpeedY<0&&(o=452),("boss"===g.stat.type||"bossExtra"===g.stat.type)&&g.enemySpeedY>0&&(o=964),g.stat.sprite=new m("enemy",e.SpriteStorage[0],[o,r],[l,u],h,p),e.enemy.push(g)}}]),t}(),m=function(){function t(e,s,i,n,o,r,l,u){a(this,t),this.Saveframes=null,this.name=e,this.pos=i,this.size=n,this.speed=o,this.frames=r,this.index=0,this.url=s,this.once=u,this.x=null,this.y=null}return o(t,[{key:"update",value:function(t){this.index+=this.speed*t}},{key:"render",value:function(){var t;if(this.speed>0){var e,s=this.frames.length;if(this.index&&(e=Math.floor(this.index)),t=this.frames[e%s],this.once&&e>=s)return void(this.once=!0)}else t=0;return this.x=this.pos[0],this.y=this.pos[1],this.Saveframes=t,this.x+=t*this.size[0]}}]),t}(),b=function(){function t(){a(this,t);var e=this;this.name=null,this.sprite=null,this.pos=[],this.settingsItems={get name(){return e.name},set name(t){return e.name=t},get sprite(){return e.sprite}}}return o(t,[{key:"lucky",value:function(t){return Math.random()<t}},{key:"setSprite",value:function(t,e,s,i,a){return this.sprite=new m(this.name,t.SpriteStorage[0],[e,s],[i,a])}}]),t}();function y(){var t=[-1.2,-1,1,1.2];return t[Math.floor(Math.random()*t.length)]}function w(){var t=[.3,.6,.8,.9,1.2];return t[Math.floor(Math.random()*t.length)]}function v(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var S=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.blink=1,this.scaleValue=1,this.frameBlink=!0,this.view="xl",this.viewMode="full",this.viewDesktop="none",this.settings={width:this.width(),height:this.height(),textureW:this.width(),textureH:this.height(),openGate:0,countModal:0,drawInX:0,drawInY:0,mouse:0},this.bullets={spriteListBulletsPosition:[106,0],spritePlayerSizeW:14,spritePlayerSizeH:32},this.items={spriteItemSize:[15,15]},this.pause={RectPause:[this.settings.width/6,40],RectPauseSize:[this.settings.width/1.5,this.settings.height/1.4],TextStageName:[this.settings.width/2.1,100],Notification:[this.settings.width/2-5,135],Menu:[this.settings.width/2.1,450],pauseLink:[350,420],sizeLinkPause:[100,30]},this.menu={background:null,TitleGame:[this.settings.width/2,100],play:[this.settings.width/2,this.settings.height/2.5],rating:[this.settings.width/2,this.settings.height/1.8],myName:[40,this.settings.height-20],version:[this.settings.width-40,this.settings.height-20],sizeLinkPlay:[200,80],coordsLinkRating:[this.settings.width/2-120,this.settings.height/1.8-40],sizeLinkRating:[250,80]},this.rating={TitleGame:[this.settings.width/2,50],return:[this.settings.width/2,165],StrokeRectCoords:[this.settings.width/9.4,200],StrokeRectSize:[this.settings.width/1.3,this.settings.height/1.8],RectCoords:[this.settings.width/9.4,200],RectSize:[this.settings.width/1.3,this.settings.height/1.8],TitleName:[this.settings.width/8,235],TitlePoints:[this.settings.width/1.45,235],ratingListX:[this.settings.width/8,this.settings.height-50],ratingListPointsX:[this.settings.width/8,this.settings.height-50],returnLinkCoords:[this.settings.width/2-60,110],returnLinkSize:[110,70]},this.gameOver={TitleCoords:[this.settings.width/2,100],win:[this.settings.width/2,100],Points:[this.settings.width/2,150],Throw:[this.settings.width/2,200],killCount:[this.settings.width/2,250],menu:[this.settings.width/2.02,450],menuLinkCoords:[350,430],menuLinkSize:[110,30]},this.playGame={spriteTextureBorder:[5,610],spriteTexture:[5,5],gamePanelCoords:[0,542],gamePanelSize:[this.settings.width,80],hpTextPosition:[this.settings.width/3,588],hpBarSize:[375,588],hpBarBoorderCoords:[this.settings.width/2.7,570],hpBarBoorderSize:[204,25],PointsCoords:[-12,20],PointsSize:[45,45],PointsGetCoords:[0,560],PointsGetSize:[35,35],PointsTextCoords:[40,592],ModalTextWASD:[this.settings.width/2,35],ModalPress:[this.settings.width/2,65],Audio:[this.settings.width,460],pauseButton:[this.settings.width-40,this.settings.height-48],pauseLinkSize:[50,50]},this.loading={loadingText:[this.settings.width/4.7,this.settings.height/2]},this.drawBuffer={canvasBuffer:null,ctxBuffer:null},this.getCanvas={canvas:document.getElementById("arena")},this.getCtx={ctx:this.getCanvas.canvas.getContext("2d")}}var e,s,i;return e=t,(s=[{key:"render",value:function(){this.getCtx.ctx.drawImage(this.drawBuffer.canvasBuffer,this.settings.drawInX,this.settings.drawInY,this.settings.width,this.settings.height),this.drawBuffer.ctxBuffer.restore()}},{key:"renderEnemys",value:function(t){"player"!==t.stat.name&&(t.stat.sprite.x=t.stat.sprite.render(),this.drawBuffer.ctxBuffer.fillStyle="red",this.drawBuffer.ctxBuffer.font="bold 12px Aria",this.drawBuffer.ctxBuffer.fillText(t.stat.health+"HP",t.move.pos[0]-5,t.move.pos[1]-5),this.drawBuffer.ctxBuffer.drawImage(t.stat.sprite.url,t.stat.sprite.x,t.stat.sprite.pos[1],t.stat.sprite.size[0],t.stat.sprite.size[1],t.move.pos[0],t.move.pos[1],t.stat.sprite.size[1],t.stat.sprite.size[1]))}},{key:"renderItems",value:function(t){var e=this;t.coins.forEach(function(t){t.lucky&&(t.sprite.x=t.sprite.render(),e.drawBuffer.ctxBuffer.drawImage(t.settingsItems.sprite.url,t.sprite.x,t.sprite.pos[1],t.sprite.size[0],t.sprite.size[1],t.pos[0],t.pos[1],e.items.spriteItemSize[0],e.items.spriteItemSize[1]))}),t.eat.forEach(function(t){t.lucky&&(t.sprite.x=t.sprite.render(),e.drawBuffer.ctxBuffer.drawImage(t.settingsItems.sprite.url,t.sprite.x,t.sprite.pos[1],t.sprite.size[0],t.sprite.size[1],t.pos[0],t.pos[1],e.items.spriteItemSize[0],e.items.spriteItemSize[1]))}),t.upgrade.forEach(function(t){t.lucky&&(t.sprite.x=t.sprite.render(),e.drawBuffer.ctxBuffer.drawImage(t.settingsItems.sprite.url,t.sprite.x,t.sprite.pos[1],t.sprite.size[0],t.sprite.size[1],t.pos[0],t.pos[1],e.items.spriteItemSize[0],e.items.spriteItemSize[1]))})}},{key:"renderPlayer",value:function(t,e){e.fade<=0&&(t.stat.sprite.x=t.stat.sprite.render(),this.drawBuffer.ctxBuffer.drawImage(t.stat.sprite.url,t.stat.sprite.x,t.stat.sprite.pos[1],t.stat.sprite.size[0],t.stat.sprite.size[1],t.move.pos[0],t.move.pos[1],t.stat.sprite.size[1],t.stat.sprite.size[1]))}},{key:"fadeIn",value:function(t,e){this.drawBuffer.ctxBuffer.restore(),this.drawBuffer.ctxBuffer.save();var s=100/(this.settings.width/2/t.loadingPercent);this.drawBuffer.ctxBuffer.globalAlpha=t.fade,this.drawBuffer.ctxBuffer.drawImage(e.SpriteStorage[1],this.settings.drawInX,this.settings.drawInX,this.settings.width,this.settings.height),this.drawBuffer.ctxBuffer.strokeStyle="gold",this.drawBuffer.ctxBuffer.lineWidth=2,this.drawBuffer.ctxBuffer.strokeRect(this.settings.width/4,this.settings.height/2.5,this.settings.width/2,this.settings.height/6),this.drawBuffer.ctxBuffer.fillStyle="brown",this.drawBuffer.ctxBuffer.fillRect(this.settings.width/4,this.settings.height/2.5,t.loadingPercent,this.settings.height/6),this.drawBuffer.ctxBuffer.font="30px PIXI",this.drawBuffer.ctxBuffer.textAlign="center",this.drawBuffer.ctxBuffer.fillStyle="white",this.drawBuffer.ctxBuffer.fillText("Rendering... ".concat(s.toFixed(1)," %"),this.settings.width/2,this.settings.height/2),t.loadingPercent<this.settings.width/2&&(t.loadingPercent+=2.5),t.loadingPercent>=this.settings.width/2&&(t.fade-=.05),this.drawBuffer.ctxBuffer.restore()}},{key:"renderEnemyBulls",value:function(t){var e=t.bull;t.bull.on&&e.bullStorage.length&&(this.drawBuffer.ctxBuffer.restore(),this.drawBuffer.ctxBuffer.drawImage(t.bull.bullStorage[0].url,t.bull.bullStorage[0].pos[0],t.bull.bullStorage[0].pos[1],t.bull.bullStorage[0].size[0],t.bull.bullStorage[0].size[1],e.pos[0],e.pos[1],this.items.spriteItemSize[0],this.items.spriteItemSize[1]),this.render(),this.drawBuffer.ctxBuffer.restore())}},{key:"renderBulls",value:function(t,e,s){e.bullets.length&&(this.drawBuffer.ctxBuffer.setTransform(1,0,0,1,0,0),this.drawBuffer.ctxBuffer.save(),this.drawBuffer.ctxBuffer.translate(t.pos.x,t.pos.y),this.drawBuffer.ctxBuffer.rotate(2*t.degree*(Math.PI/180)),this.drawBuffer.ctxBuffer.drawImage(t.sprite.url,t.sprite.pos[0],t.sprite.pos[1],t.sprite.size[0],t.sprite.size[1],this.settings.drawInX,this.settings.drawInY,25,27),t.degree++,this.drawBuffer.ctxBuffer.restore())}},{key:"renders",value:function(t,e,s,i,a){var n=this;"play"===s.about.state&&t.stat.health<=0&&t.GameOver(t,s,e,a),("play"===s.about.state||"play-animation"===s.about.state)&&this.renderMouse(e,i),"wait"===s.about.state&&this.gameOverView(t,i,s),"rating"===s.about.state&&this.drawRatingList(e,t,i,t),"play"===s.about.state&&(e.enemy.forEach(function(t){n.renderEnemys(t),n.renderItems(e)}),this.renderPlayer(t,s),e.bullets.forEach(function(s){n.renderBulls(s,e,t)}),e.enemy.forEach(function(t){n.renderEnemyBulls(t)})),"play-animation"===s.about.state&&(s.fade>0&&this.fadeIn(s,e),s.fade<=0&&this.renderPlayer(t,s)),this.pauseMenuView(s,t,i,e),"menu"===s.about.state&&i&&this.DrawMenu(e,s,i),"pause"===s.about.state&&i&&(i.linki[0].selectName&&(s.about.state="menu"),i.linki[0].selectName&&this.DrawMenu(e,s,i)),this.render()}},{key:"pauseMenuView",value:function(t,e,s,i){if("pause"===t.about.state){var a=this.drawBuffer.ctxBuffer;a.restore(),a.save(),a.fillStyle="black",a.globalAlpha=.9,this.drawBuffer.ctxBuffer.drawImage(i.SpriteStorage[1],this.pause.RectPause[0],this.pause.RectPause[1],this.pause.RectPauseSize[0],this.pause.RectPauseSize[1]),a.strokeStyle="gold",a.globalAlpha=.9,a.strokeRect(this.pause.RectPause[0]+10,this.pause.RectPause[1]+10,this.pause.RectPauseSize[0]-20,this.pause.RectPauseSize[1]-20),a.fillStyle="yellow",a.textAlign="center",a.shadowColor="rgb(50,50,50)",a.shadowOffsetX=2,a.shadowOffsetY=3,a.font="50px PIXI",a.fillText("PAUSE",this.pause.TextStageName[0],this.pause.TextStageName[1]),a.fillStyle="gold",a.shadowColor="rgb(50,80,50)",a.textAlign="center",a.shadowOffsetX=2,a.shadowOffsetY=3,a.font="25px PIXI",a.fillText("If you leave the game, all saves will be lost.",this.pause.Notification[0],this.pause.Notification[1]),a.restore(),a.save(),a.fillStyle="yellow",a.shadowColor="brown",a.textAlign="center",a.font="35px PIXI",a.fillText("Throws: "+e.countThrow,this.gameOver.Throw[0]-20,this.gameOver.Throw[1]),a.fillText("Kills: "+e.killCount,this.gameOver.killCount[0]-20,this.gameOver.killCount[1]+10),s.checkFrame(s.linki[0])?a.fillStyle=s.linki[0].selectColor:a.fillStyle=s.linki[0].color,a.shadowOffsetX=2,a.shadowOffsetY=3,a.textAlign="center",a.font="40px PIXI",a.fillText("MENU",this.pause.Menu[0],this.pause.Menu[1]),this.render()}else this.drawBuffer.ctxBuffer.clearRect(0,0,this.settings.width,this.settings.health)}},{key:"DrawMenu",value:function(t,e,s,i){var a=this.drawBuffer.ctxBuffer;this.menu.background=a.createPattern(t.SpriteStorage[3],"repeat"),a.fillRect(this.settings.drawInX,this.settings.drawInY,this.settings.width,this.settings.height),a.fillStyle=this.menu.background,a.fillRect(this.settings.drawInX,this.settings.drawInY,this.settings.width,this.settings.height),a.fillStyle="rgb(255,215,0)",a.shadowColor="brown",a.shadowBlur=3,a.textAlign="center",a.textBaseline="middle",a.shadowOffsetX=6,a.shadowOffsetY=7,a.font="bold 100px PIXI",a.globalAlpha=this.blink,this.blink<=.5&&(this.frameBlink=!1),this.blink>=1&&(this.frameBlink=!0),this.frameBlink&&this.blink>.5&&(this.blink-=.01),!this.frameBlink&&1!=this.blink&&(this.blink+=.01),a.fillText("ARENA",this.menu.TitleGame[0],this.menu.TitleGame[1]),a.shadowOffsetX=0,a.shadowOffsetY=0,a.globalAlpha=1,a.shadowColor="black",a.font="100px PIXI",s.checkFrame(s.linki[1])&&(a.fillStyle=s.linki[1].selectColor),!s.checkFrame(s.linki[1])&&(a.fillStyle=s.linki[1].color),a.fillText("PLAY",this.menu.play[0],this.menu.play[1]),s.checkFrame(s.linki[2])&&(a.fillStyle=s.linki[2].selectColor),!s.checkFrame(s.linki[2])&&(a.fillStyle=s.linki[2].color),a.fillText("RATING",this.menu.rating[0],this.menu.rating[1]),"demo"===this.viewMode&&(a.fillStyle="lightblue",a.font="20px bold Aria",a.fillText("This is a demo game.",this.settings.width/2,this.settings.height-120),a.fillText("Your device doesn't support :(",this.settings.width/2,this.settings.height-100),a.fillText("Need width 760px and more for full.",this.settings.width/2,this.settings.height-80)),a.fillStyle="white",a.font="bold 14px Arial",a.fillText("© 2019",this.menu.myName[0],this.menu.myName[1]),a.fillStyle="white",a.font="bold 14px Arial",a.fillText("v0.0.5",this.menu.version[0],this.menu.version[1])}},{key:"drawRatingList",value:function(t,e,s){var i,a=this.drawBuffer.ctxBuffer,n=null,o=null,r="mobile"===this.view;!r&&(o=t.startRecord.length<8?t.startRecord.length:8),r&&(o=t.startRecord.length<5?t.startRecord.length:5),!r&&(n=275),r&&(n=Math.floor(350/1.5)),a.restore(),a.save(),a.textAlign="center",a.textBaseline="middle",a.fillStyle=this.menu.background,a.fillRect(this.settings.drawInX,this.settings.drawInY,this.settings.width,this.settings.height),a.fillStyle=this.menu.background,a.fillRect(this.settings.drawInX,this.settings.drawInY,this.settings.width,this.settings.height),a.fillStyle="rgb(255,215,0)",a.shadowColor="brown",a.shadowBlur=3,a.shadowOffsetX=6,a.shadowOffsetY=7,a.font=r?"bold 60px PIXI":"bold 80px PIXI",r&&(this.rating.TitleGame[1]=40),r&&a.fillText("THE BEST",this.rating.TitleGame[0],this.rating.TitleGame[1]),!r&&a.fillText("THE BEST",this.rating.TitleGame[0],this.menu.TitleGame[1]),a.restore(),a.save(),(i=s.checkFrame(s.linki[3]))&&(a.fillStyle=s.linki[3].selectColor),!i&&(a.fillStyle=s.linki[3].color),a.font=r?"bold 40px PIXI":"bold 50px PIXI",r&&(this.rating.return[1]=120),a.fillText("RETURN",this.rating.return[0],this.rating.return[1]),a.strokeStyle="yellow",r&&(this.rating.StrokeRectCoords[1]=140),a.strokeRect(this.rating.StrokeRectCoords[0],this.rating.StrokeRectCoords[1],this.rating.StrokeRectSize[0],this.rating.StrokeRectSize[1]),a.fillStyle="black",r&&(this.rating.RectCoords[1]=140),a.fillRect(this.rating.RectCoords[0],this.rating.RectCoords[1],this.rating.RectSize[0],this.rating.RectSize[1]),a.textAlign="left",a.font="bold 45px PIXI",a.fillStyle="yellow",!r&&a.fillText("NAME",this.rating.TitleName[0],this.rating.TitleName[1]),r&&(a.textAlign="center"),r&&a.fillText("NAME",this.settings.width/2.1,this.rating.TitleName[1]/1.3),r&&"half-half"!==this.viewDesktop||(a.fillStyle="yellow",a.fillText("POINTS",this.rating.RectSize[0]-70,this.rating.TitlePoints[1])),a.font="bold 40px PIXI",a.fillStyle="yellow";for(var l=0;l<o;l++)r&&(a.textAlign="left"),this.rating.ratingListX[0]=this.rating.RectCoords[0]+10,a.fillText("".concat(l+1,". ")+t.startRecord[t.startRecord.length-(l+1)].name,this.rating.ratingListX[0],n),r&&"half-half"!==this.viewDesktop||a.fillText(t.startRecord[t.startRecord.length-(l+1)].points,this.rating.RectSize[0]-50,n),n+=32;a.textAlign="center",a.fillStyle="white",a.font="bold 14px Arial",a.restore(),a.save(),a.fillText("© 2019",this.menu.myName[0],this.menu.myName[1]),a.fillStyle="white",a.font="bold 14px Arial",a.fillText("v0.0.5",this.menu.version[0],this.menu.version[1])}},{key:"gameOverView",value:function(t,e,s){this.drawBuffer.ctxBuffer.save();var i=this.drawBuffer.ctxBuffer,a=e.checkFrame(e.linki[4]);i.fillStyle="grey",i.globalAlpha=.8,i.fillRect(0,0,this.settings.width,this.settings.height-75),i.fillStyle="red",i.textAlign="center",i.font="100px PIXI",s.about.stageNumber>=20&&t.stat.health>0&&i.fillText("W I N",this.gameOver.win[0],this.gameOver.win[1]),t.stat.health<=0&&i.fillText("GAME OVER",this.gameOver.TitleCoords[0],this.gameOver.TitleCoords[1]),i.shadowColor="brown",i.shadowOffsetX=2,i.shadowOffsetY=3,i.font="40px PIXI",i.fillStyle="yellow",i.shadowColor="brown",i.fillText("Points: "+t.stat.points,this.gameOver.Points[0],this.gameOver.Points[1]),i.fillText("Throws: "+t.countThrow,this.gameOver.Throw[0],this.gameOver.Throw[1]),i.fillText("Kills: "+t.killCount,this.gameOver.killCount[0],this.gameOver.killCount[1]),a&&(i.fillStyle=e.linki[4].selectColor),!a&&(i.fillStyle=e.linki[4].color),i.font="50px PIXI",i.fillText("MENU",this.gameOver.menu[0],this.gameOver.menu[1]),this.render()}},{key:"building",value:function(t,e,s){this.drawBuffer.canvasBuffer=document.createElement("canvas"),this.drawBuffer.ctxBuffer=this.drawBuffer.canvasBuffer.getContext("2d"),this.drawBuffer.canvasBuffer.setAttribute("width",this.settings.width),this.drawBuffer.canvasBuffer.setAttribute("height",this.settings.height);var i=this.drawBuffer.ctxBuffer;i.drawImage(t.TextureStorage[0],this.playGame.spriteTextureBorder[0],this.playGame.spriteTextureBorder[1],this.settings.textureW,this.settings.textureH,this.settings.drawInX,this.settings.drawInY,this.settings.textureW,this.settings.textureH),i.drawImage(t.TextureStorage[0],this.playGame.spriteTexture[0],this.playGame.spriteTexture[1],this.settings.textureW,this.settings.textureH,this.settings.drawInX,this.settings.drawInY,this.settings.textureW,this.settings.textureH),i.drawImage(t.SpriteStorage[0],-14,190,85,65,109,0,95,65),"play-animation"===s.about.state?(-50!==this.settings.openGate&&this.settings.openGate--,i.drawImage(t.SpriteStorage[0],-14,190,85,65,349,this.settings.openGate,95,65)):(0!==this.settings.openGate&&this.settings.openGate++,i.drawImage(t.SpriteStorage[0],-14,190,85,65,349,this.settings.openGate,95,65)),i.drawImage(t.SpriteStorage[0],-14,190,85,65,588,0,95,65);var a=this.drawBuffer.ctxBuffer.createLinearGradient(0,0,170,0);a.addColorStop(0,"rgb(105,105,105)"),a.addColorStop(.5,"rgb(128,128,128)"),a.addColorStop(1,"rgb(169,169,169)"),i.fillStyle=a,i.fillRect(this.playGame.gamePanelCoords[0],this.playGame.gamePanelCoords[1],this.playGame.gamePanelSize[0],this.playGame.gamePanelSize[1]),i.strokeStyle="blue",i.lineWidth=5,"mobile"===this.view&&(this.playGame.hpBarBoorderCoords[0]=this.settings.width/4),i.strokeRect(this.playGame.hpBarBoorderCoords[0],this.playGame.hpBarBoorderCoords[1],this.playGame.hpBarBoorderSize[0],this.playGame.hpBarBoorderSize[1]),i.fillStyle="crimson",e.stat.health<=0&&i.fillRect(this.playGame.hpBarBoorderCoords[0]+2,this.playGame.hpBarBoorderCoords[1]+2,0,20),!(e.stat.health<=0)&&i.fillRect(this.playGame.hpBarBoorderCoords[0]+2,this.playGame.hpBarBoorderCoords[1]+2,e.stat.health,20),i.fillStyle="white",i.font="bold 15px PIXI","mobile"!=this.view&&i.fillText(e.stat.health+"HP",this.playGame.hpBarSize[0],this.playGame.hpBarSize[1]),i.fillStyle="red",i.shadowColor="rgb(255,255,25)",i.shadowOffsetX=2,i.shadowOffsetY=3,i.font="bold 30px PIXI",i.fillText(s.about.stageNumber+" LVL",10,30),i.shadowOffsetX=0,i.shadowOffsetY=0,i.drawImage(t.SpriteStorage[0],this.playGame.PointsCoords[0],this.playGame.PointsCoords[1],this.playGame.PointsSize[0],this.playGame.PointsSize[1],this.playGame.PointsGetCoords[0],this.playGame.PointsGetCoords[1],this.playGame.PointsGetSize[0],this.playGame.PointsGetSize[1]),i.fillStyle="gold",i.font="bold 27px PIXI",i.fillText(e.stat.points,this.playGame.PointsTextCoords[0],this.playGame.PointsTextCoords[1]),i.drawImage(t.SpriteStorage[2],this.playGame.pauseButton[0],this.playGame.pauseButton[1],20,20),"play"===s.about.state&&0===this.settings.countModal&&(i.fillStyle="black",i.globalAlpha="0.8",i.fillRect(0,0,this.settings.width,100),i.textAlign="center",i.fillStyle="white",i.font="PIXI 30px bold",i.fillText("Move with the WASD keys",this.playGame.ModalTextWASD[0],this.playGame.ModalTextWASD[1]),i.textAlign="center",i.fillStyle="lightblue",i.font="PIXI 20px bold",i.fillText("Press any keys",this.playGame.ModalPress[0],this.playGame.ModalPress[1]),i.restore())}},{key:"loadingRender",value:function(t){this.getCtx.ctx.fillRect(this.settings.drawInX,this.settings.drawInY,this.settings.width,this.settings.height),this.getCtx.ctx.fillStyle="grey",this.getCtx.ctx.textAlign="center","mobile"!=this.view?this.getCtx.ctx.font="100px Aria bold":this.getCtx.ctx.font="45px Aria bold",this.getCtx.ctx.fillText("My project",this.settings.width/2,this.settings.height/2)}},{key:"renderMouse",value:function(t,e){this.drawBuffer.ctxBuffer.drawImage(t.SpriteStorage[0],255,192,65,65,e.coordsMouseX-32.5,e.coordsMouseY-32.5,65,65)}},{key:"buildingGetNameView",value:function(t,e){var s=t.createElement("input"),i=t.createElement("input"),a=t.createElement("input"),n=t.createElement("div"),o=t.createElement("div"),r=t.createElement("div");o.classList.add("modal-window"),r.classList.add("background-modal"),s.classList.add("name"),a.classList.add("btnName"),i.classList.add("cancelName"),n.classList.add("center"),s.setAttribute("type","text"),s.setAttribute("maxlength","11"),s.placeholder="NAME",a.setAttribute("type","button"),a.value="SAVE",i.setAttribute("type","button"),i.value="NO",n.appendChild(s),n.appendChild(a),n.appendChild(i),o.appendChild(n),r.appendChild(o),t.body.insertBefore(r,e)}},{key:"deleteGetNameView",value:function(t){t.querySelector(".background-modal").remove()}},{key:"height",value:function(){return window.screen.availHeight<620?(this.view="mobile",window.screen.availHeight):620}},{key:"width",value:function(){return window.screen.availWidth<800?(760<window.screen.availWidth&&window.screen.availWidth<800&&(this.viewDesktop="half-half"),window.screen.availWidth<760&&(this.viewMode="demo"),this.view="mobile",window.screen.availWidth-10):800}}])&&v(e.prototype,s),i&&v(e,i),t}();function x(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var k=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.count=0,this.canvasLeft=null,this.canvasTop=null,this.inputState={UP:!1,DOWN:!1,LEFT:!1,RIGHT:!1,ESCAPE:!1}}var e,s,i;return e=t,(s=[{key:"setEvent",value:function(t,e,s,i,a,n){var o=this,r=document.getElementById("arena"),l=document.getElementsByClassName("name")[0];document.addEventListener("keydown",function(e){if("name"===e.target.className)return 0;if(0===t.settings.countModal&&"play"===i.about.state&&t.settings.countModal++,"play"===i.about.state||"pause"===i.about.state)return o.inputState.ESCAPE?(i.about.state="play",o.setKeyState(e.which,!1)):o.setKeyState(e.which,!0);e.preventDefault()},!1),document.addEventListener("keyup",function(t){if("play"===i.about.state||"pause"===i.about.state)return o.inputState.ESCAPE?void 0:o.setKeyState(t.which,!1);t.preventDefault()},!1),document.addEventListener("mousemove",function(t){t.target===r&&(o.canvasLeft=r.offsetLeft,o.canvasTop=r.offsetTop,a.coordsMouseX=t.pageX-o.canvasLeft,a.coordsMouseY=t.pageY-o.canvasTop,a.coorddX=a.coordsMouseX-e.move.pos[0],a.coorddY=a.coordsMouseY-e.move.pos[1])}),document.addEventListener("click",function(s){"btnName"===s.target.className&&""!==l.value?(getName(l.value,e),t.deleteGetNameView(document,s.target)):"cancelName"===s.target.className&&t.deleteGetNameView(document,s.target)},!1),t.getCanvas.canvas.addEventListener("click",function(r){if("loading"===i.about.state||"play-animation"===i.about.state)return void r.preventDefault();for(var l=a.linki,u=0;u<l.length;u++)a.checkFrame(l[u])&&l[u].Name===i.about.state?l[u].selectName=!0:l[u].selectName=!1;if("demo"===t.viewMode&&(a.linki[1].selectName=!1),"menu"===i.about.state||"rating"===i.about.state||"wait"===i.about.state)for(var h in o.inputState)o.inputState[h]=!1;else{if(o.inputState.ESCAPE||a.linki[5].selectName)return;e.stat.bullets.useSkill(s,e,a,n)}},!1)}},{key:"setKeyState",value:function(t,e){switch(t){case 65:this.inputState.LEFT=e;break;case 87:this.inputState.UP=e;break;case 68:this.inputState.RIGHT=e;break;case 83:this.inputState.DOWN=e;break;case 27:this.inputState.ESCAPE=e}}},{key:"inputs",value:function(t,e){this.inputState.RIGHT&&(e.stat.sprite.size[0]=34,e.stat.sprite.pos[0]=572.1,e.move.pos[0]+=e.move.speeds*t),this.inputState.LEFT&&(e.stat.sprite.size[0]=33,e.stat.sprite.pos[0]=828,e.stat.sprite.frames=[0,1],e.move.pos[0]-=e.move.speeds*t),this.inputState.UP&&(e.stat.sprite.size[0]=34,e.stat.sprite.pos[0]=444,e.move.pos[1]-=e.move.speeds*t),this.inputState.DOWN&&(e.stat.sprite.size[0]=34,e.stat.sprite.pos[0]=700,e.move.pos[1]+=e.move.speeds*t),this.inputState.UP&&this.inputState.RIGHT?(e.stat.sprite.size[0]=33,e.stat.sprite.pos[0]=510):this.inputState.UP&&this.inputState.LEFT&&(e.stat.sprite.size[0]=34,e.stat.sprite.pos[0]=891),this.inputState.DOWN&&this.inputState.LEFT?(e.stat.sprite.size[0]=33,e.stat.sprite.pos[0]=766):this.inputState.DOWN&&this.inputState.RIGHT&&(e.stat.sprite.size[0]=33,e.stat.sprite.pos[0]=636.5)}},{key:"dataBaseListener",value:function(t){cloudDB.use.collection("users").where("realPlayer","==",!0).onSnapshot(function(e){t.startRecord=[],e.forEach(function(e){t.startRecord.push(e.data())}),t.startRecord.sort(B)})}}])&&x(e.prototype,s),i&&x(e,i),t}();function B(t,e){return t.points<e.points?-1:t.points>e.points?1:0}function P(t,e,s,i,a,n){e.gameTime+=t,"play-animation"===i.about.state&&i.fade<=0&&function(t,e,s){t.move.animationPos[1]>=t.move.pos[1]?t.move.pos[1]+=t.move.speeds*s:e.about.state="play"}(e,i,t),"play"!==i.about.state&&"wait"!==i.about.state||(e.GameOver(e,i,s,n),e.Win(e,i,s)),i.pause(a[5])||"pause"===i.about.state||"menu"===i.about.state||"rating"===i.about.state||(function(t,e,s,i,a){e.stat.sprite.update(t),Date.now()-i.about.lastTimeBull>10&&(s.enemy.forEach(function(n){var o,r,l,u=n.bull.pos[0],h=n.bull.pos[1],p=e.move.pos[0],f=e.move.pos[1];if(n.stat.sprite.update(t),n.bull.bullStorage.length&&(n.bull.pos[0]<=40||n.bull.pos[0]>755||n.bull.pos[1]<60||n.bull.pos[1]>440))return n.bull.bullStorage.splice(0,1),n.bull.pos[0]=n.move.pos[0],void(n.bull.pos[1]=n.move.pos[1]);n.bull.bullStorage.length||("boss"===n.stat.type&&(o=new m("bull2",s.SpriteStorage[0],[192,2],[30,30],0)),"bossExtra"===n.stat.type&&(o=new m("bull2",s.SpriteStorage[0],[354,2],[30,30],0)),"common"===n.stat.type&&(o=new m("bull2",s.SpriteStorage[0],[324,0],[30,30],0)),n.bull.bullStorage.push(o),n.bull.speed=150,n.bull.speedY=150,n.bull.speed*=(r=[-1.2,-1,1,1.2],l=Math.floor(Math.random()*r.length),r[l]));if(n.bull.pos[0]+=n.bull.speed*t,n.bull.pos[1]+=n.bull.speedY*t,n.bull.on="true",T([u,h],[30,30],[p,f],[32,32])){var c=(new Date).getTime(),d=a.effects.find(function(t){return"damage"===t.name});c>i.about.lastTime+1e3*d.buffer.duration&&(d.play(!1,.8),i.about.lastTime=c),e.stat.sprite.pos[0]=956,e.stat.health--,e.move.pos[1]++;setTimeout(function(){e.stat.sprite.pos[0]=700},200)}!function(t){t&&t.move.pos[0]>700&&(t.enemySpeedX*=-1,("boss"===t.stat.type||"bossExtra"===t.stat.type)&&(t.stat.sprite.pos[0]=1226));t&&t.move.pos[0]<70&&(t.enemySpeedX*=-1,("boss"===t.stat.type||"bossExtra"===t.stat.type)&&(t.stat.sprite.pos[0]=712));t&&t.move.pos[1]<70&&(t.enemySpeedY*=-1,("boss"===t.stat.type||"bossExtra"===t.stat.type)&&(t.stat.sprite.pos[0]=964));t&&t.move.pos[1]>400&&(t.enemySpeedY*=-1,("boss"===t.stat.type||"bossExtra"===t.stat.type)&&(t.stat.sprite.pos[0]=452))}(n),n.move.pos[0]+=n.enemySpeedX,n.move.pos[1]+=n.enemySpeedY}),i.about.lastTimeBull=Date.now())}(t,e,s,i,n),function(t,e,s){s.bullets.forEach(function(s,i,a){var n=s;!function(t,e,s){var i=new Vector(t.pos.x,t.pos.y),a=t.direction.multiply(e.stat.bullets.weapons.speed*s);t.pos=i.add(a)}(s,e,t),(n.pos.y<50||n.pos.y>440||n.pos.x>727||n.pos.x<35)&&(a.splice(i,1),i--)})}(t,e,s),function(t,e){var s=[],i=[];t.bullets.forEach(function(a,n){s[0]=a.pos.x,s[1]=a.pos.y,t.enemy.forEach(function(a){i[0]=a.move.pos[0],i[1]=a.move.pos[1],T(i,[35,35],s,[35,35])&&a.stat.health>0&&(a.stat.health-=e.stat.damage,t.bullets.splice(n,1))})})}(s,e),function(t,e,s){var i=[],a=[];t.coins.forEach(function(t,n,o){i[0]=t.pos[0],i[1]=t.pos[1],a[0]=e.move.pos[0],a[1]=e.move.pos[1],T(a,[26,26],i,[26,26])&&(s.effects.find(function(t){return"money"===t.name}).play(!1,.8),e.stat.points+=10,o.splice(n,1))}),t.eat.forEach(function(t,n,o){i[0]=t.pos[0],i[1]=t.pos[1],a[0]=e.move.pos[0],a[1]=e.move.pos[1],T(a,[26,26],i,[26,26])&&(e.stat.health<200&&e.stat.health+.2*e.stat.health<200?(s.effects.find(function(t){return"eat"===t.name}).play(!1,.8),e.stat.health+=Math.floor(32),o.splice(n,1)):setTimeout(function(){o.splice(n,1)},2e3))}),t.upgrade.forEach(function(t,n,o){i[0]=t.pos[0],i[1]=t.pos[1],a[0]=e.move.pos[0],a[1]=e.move.pos[1],T(a,[30,30],i,[30,30])&&(s.effects.find(function(t){return"lvlUp"===t.name}).play(!1,.8),e.stat.damage+=5,o.splice(n,1))})}(s,e,n),function(t,e,s,i){t.enemy.forEach(function(a,n,o){if(a.stat.health<=0){if(!1===a.stat.onDeath){if(a.stat.onDeath=!0,e.stat.whatDrop=Math.random()<.5,e.stat.upgradeRate=Math.random()<.05,function(t){t.stat.sprite.once=!0,t.stat.sprite.speed=10,t.stat.sprite.index=0,t.stat.sprite.Saveframes=0,t.enemySpeedX=0,t.enemySpeedY=0,t.bull.on=!1,t.bull.bullStorage=[]}(a),"common"===a.stat.type&&(a.stat.sprite.pos[0]=960),"common"===a.stat.type&&(a.stat.sprite.pos[1]=102),"boss"===a.stat.type&&(a.stat.sprite.pos[0]=1540),"boss"===a.stat.type&&(a.stat.sprite.pos[1]=232),"boss"===a.stat.type&&(a.stat.sprite.frames=[0,1,2]),"bossExtra"===a.stat.type&&(a.stat.sprite.pos[0]=1542),"bossExtra"===a.stat.type&&(a.stat.sprite.pos[1]=298),"bossExtra"===a.stat.type&&(a.stat.sprite.frames=[0,1,2]),e.stat.whatDrop){var r=new b;r.settingsItems.name="coin",r.lucky(.7)?(r.setSprite(t,69,30,26,37),r.pos[0]=a.move.pos[0],r.pos[1]=a.move.pos[1],t.coins.push(r)):r=null}else{var l=new b;l.settingsItems.name="eat",l.lucky(.5)?(l.setSprite(t,95,30,39,40),l.pos[0]=a.move.pos[0],l.pos[1]=a.move.pos[1],t.eat.push(l)):l=null}if(e.stat.upgradeRate=!0,e.stat.upgradeRate){var u=new b;u.settingsItems.name="scroll",u.lucky(.2)?(u.setSprite(t,128,192,42,44),u.pos[0]=a.move.pos[0]+5,u.pos[1]=a.move.pos[1]+5,t.upgrade.push(u)):u=null}e.killCount++,a.sound.play(!1,1)}a.stat.sprite.index>=a.stat.sprite.frames.length&&(a.DeathTimer=null,o.splice(n,1),e.stat.points+=25)}!function(t,e,s,i){if(t&&T([t.move.pos[0],t.move.pos[1]],[30,30],[e.move.pos[0],e.move.pos[1]],[32,32]))if(e.stat.health>-1){e.stat.sprite.pos[0]=956;var a=(new Date).getTime(),n=s.effects.find(function(t){return"damage"===t.name});a>i.about.lastTimeColl+1e3*n.buffer.duration&&(n.play(!1,.8),i.about.lastTimeColl=a),e.stat.health--,e.move.pos[1]++;setTimeout(function(){e.stat.sprite.pos[0]=700},0)}else e.stat.health=0}(a,e,s,i)})}(s,e,n,i))}function T(t,e,s,i){return a=t[0],n=t[1],o=t[0]+e[0],r=t[1]+e[1],l=s[0],u=s[1],h=s[0]+i[0],p=s[1]+i[1],!(o<=l||a>h||r<=u||n>p);var a,n,o,r,l,u,h,p}function I(t,e,s,i,a,n){this.url=t,this.Name=e,this.pos=[s,i],this.length=[a,n],this.color="red",this.selectColor="rgb(255,140,0)",this.selectName=!1}(function(){document.getElementById("arena").classList.add("canvasInit");var t=null,e=null,s=null,a=new u;a.init(),a.load("audio/main.mp3","additional"),a.load("audio/shot.mp3","shot"),a.load("audio/Fly_A_Kite.mp3","main"),a.load("audio/money.wav","money"),a.load("audio/eat.wav","eat"),a.load("audio/damage.wav","damage"),a.load("audio/death_boss.wav","deathBoss"),a.load("audio/death-bat.mp3","deathBat"),a.load("audio/death-bossExtra.wav","bossExtra"),a.load("audio/gameOver.wav","gameOver"),a.load("audio/lvl.mp3","lvl"),a.load("audio/lvlUP.wav","lvlUp"),a.load("audio/lvlUP.wav","lvlUp2"),a.load("audio/select.wav","select"),console.log(a);var n=new p,o=new S,d=new k,m=new h,b=new f,y=new l;!localStorage.IP&&y.getIP(b);var w=new r;w.updateLimit(),y.getSpriteData(b),o.getCanvas.canvas.setAttribute("width",o.settings.width),o.getCanvas.canvas.setAttribute("height",o.settings.height),"mobile"===o.view&&o.getCanvas.canvas.classList.add("scale"),"mobile"!=o.view?(m.linki.push(new I("PAUSE","pause",o.pause.pauseLink[0],o.pause.pauseLink[1],o.pause.sizeLinkPause[0],o.pause.sizeLinkPause[1])),m.linki.push(new I("PLAY","menu",o.menu.play[0]-85,o.menu.play[1]-45,o.menu.sizeLinkPlay[0],o.menu.sizeLinkPlay[1])),m.linki.push(new I("RATING","menu",o.menu.coordsLinkRating[0],o.menu.coordsLinkRating[1],o.menu.sizeLinkRating[0],o.menu.sizeLinkRating[1])),m.linki.push(new I("RETURN","rating",o.rating.returnLinkCoords[0],o.rating.returnLinkCoords[1],o.rating.returnLinkSize[0],o.rating.returnLinkSize[1])),m.linki.push(new I("MENU","wait",o.gameOver.menuLinkCoords[0],o.gameOver.menuLinkCoords[1],o.gameOver.menuLinkSize[0],o.gameOver.menuLinkSize[1])),m.linki.push(new I("PAUSE-MENU","play",o.playGame.pauseButton[0],o.playGame.pauseButton[1],o.playGame.pauseLinkSize[0],o.playGame.pauseLinkSize[1]))):(m.linki.push(new I("PAUSE","pause",o.pause.pauseLink[0],o.pause.pauseLink[1],100,30)),m.linki.push(new I("PLAY","menu",o.menu.play[0]-85,o.menu.play[1]-45,200,80)),m.linki.push(new I("RATING","menu",o.menu.coordsLinkRating[0],o.menu.coordsLinkRating[1],250,80)),m.linki.push(new I("RETURN","rating",o.rating.return[0]-40,o.rating.returnLinkCoords[1]-10,o.rating.returnLinkSize[0],o.rating.returnLinkSize[1]))),b.loading("Image","img/texture.png","texture"),b.loading("Image","img/sheet_objects_heroes.png","sprite"),b.loading("Image","img/menu_800x600.jpg","sprite"),b.loading("Image","img/pause.png","sprite"),b.loading("Image","img/box_background.png","sprite"),b.loading("Image","img/box.png","sprite"),o.loadingRender(b);var v=new g,x=new c(b,o);function B(){e=Date.now(),s=(e-t)/1e3,function(t,e,s){m.linki.slice(1,m.linki.length).some(function(t){return t.selectName})&&s.effects.find(function(t){return"select"===t.name}).play(!1,1),m.linki[1].selectName&&n.startGameAnimation(t,e,m.linki[1],s),m.linki[2].selectName&&n.ratingGame(m.linki[2]),m.linki[3].selectName&&n.mainMenu(m.linki[3]),"demo"!=o.viewMode&&(m.linki[4].selectName||m.linki[0].selectName)&&n.mainMenu(m.linki[4],s),"demo"!=o.viewMode&&m.linki[5].selectName&&n.pause(m.linki[5],d.inputState.ESCAPE)}(b,x,a),function(t,e){"menu"===n.about.state&&(e.setHealth(200),n.setRequstCount(0))}(0,x),function(t,e,s,i){"play-animation"===s.about.state&&o.building(t,e,s),"play"!==s.about.state||t.enemy.length||(s.about.stageNumber>=20&&e.setHealth(0),s.about.stageNumber>=10?(s.about.stageNumber++,s.about.stageBossCount++,s.about.stageExtraBossCount++):s.about.stageNumber>=7&&(s.about.stageNumber++,s.about.stageBossCount++),s.about.stageNumber<7&&s.about.stageNumber++,s.spawnAndLvling(s,t,v,s.about.stageNumber,i))}(b,x,n,a),n.pause(m.linki[5],d.inputState.ESCAPE)||"play"!==n.about.state||d.inputs(s,x),P(s,x,b,n,m.linki,a),function(t,e){"pause"===t.about.state&&!e.inputState.ESCAPE&&(e.inputState.ESCAPE=!0)}(n,d),function(t,e,s){var i;"play"===t.about.state&&((i=s).move.pos[0]<=35&&(i.move.pos[0]=35),i.move.pos[0]>=727&&(i.move.pos[0]=727),i.move.pos[1]<=55&&(i.move.pos[1]=55),i.move.pos[1]>=440&&(i.move.pos[1]=440)),("play"===t.about.state||"wait"===t.about.state)&&o.building(e,s,t)}(n,b,x),o.renders(x,b,n,m,a),function(t,e,s,i){if("wait"===t.about.state&&0===t.about.requstCount&&e.stat.health<=0){localStorage.name&&(e.stat.gamerName=localStorage.name),!localStorage.name&&(e.stat.gamerName="player"+Math.random().toFixed(3).toString());var a="_id"+s.startRecord.length,n={result:{name:e.stat.gamerName,points:e.stat.points,id:a.slice(1,a.length),ip:localStorage.IP}};localStorage.setItem("result",JSON.stringify(n)),w.updateUserData(localStorage.IP,a,e.stat.gamerName,e.stat.points,s),t.about.requstCount++}}(n,x,b),t=e,requestAnimationFrame(B)}b.enemy.forEach(function(){b.enemy[i].bull.pos[0]=b.enemy[i].move.pos[0],b.enemy[i].bull.pos[1]=b.enemy[i].move.pos[1],b.enemy[i].enemySpeed*=getRandomPull()}),!localStorage.name&&o.buildingGetNameView(document,o.getCanvas.canvas),setTimeout(function(){n.about.state="menu",requestAnimationFrame(B)},3e3),d.setEvent(o,x,b,n,m,a),o.building(b,x,n),d.dataBaseListener(b)})()}]);
//# sourceMappingURL=http://localhost:9001/../main.js.map